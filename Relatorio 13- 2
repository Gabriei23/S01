(defstruct criatura
  nome
  ambiente
  periculosidade
  vida-media)

(defparameter *catalogo*
  (list
   (make-criatura :nome "Peixe Safe Shallows"
                  :ambiente "Safe Shallows"
                  :periculosidade "Baixa"
                  :vida-media 5)
   (make-criatura :nome "Reaper Leviathan"
                  :ambiente "Deep"
                  :periculosidade "Alta"
                  :vida-media 20)
   (make-criatura :nome "Crab Squid"
                  :ambiente "Deep"
                  :periculosidade "Média"
                  :vida-media 12)
   (make-criatura :nome "Ghost Ray"
                  :ambiente "Deep"
                  :periculosidade "Baixa"
                  :vida-media 8)))

(defun filtra-por-perigo (catalogo)
  (remove-if (lambda (c)
               (string-equal (criatura-periculosidade c) "Baixa"))
             catalogo))

(defun relatorio-profundidade (catalogo)
  (mapcar (lambda (c)
            (format nil "~A: Vive em ~A"
                    (criatura-nome c)
                    (criatura-ambiente c)))
          (remove-if-not (lambda (c)
                           (string-equal (criatura-ambiente c) "Deep"))
                         catalogo)))

(format t "~%--- Criaturas Perigosas ---~%")
(dolist (c (filtra-por-perigo *catalogo*))
  (format t "~A (~A)~%" (criatura-nome c) (criatura-periculosidade c)))

(format t "~%--- Relatório Deep ---~%")
(dolist (linha (relatorio-profundidade *catalogo*))
  (format t "~A~%" linha))
